CREATE TABLE bill (
                      id_bill integer NOT NULL generated BY DEFAULT as identity ( increment 1 start 1 minvalue 1 maxvalue 9000 cache 1),
                      table_number int DEFAULT NULL,
                      bill_time varchar NOT NULL,
                      id_restaurant int NOT NULL,
                      waiterName varchar(100) NOT NULL,
                      finalAmount int NOT NULL
) ;


INSERT INTO bill ( table_number, bill_time, id_restaurant, waiterName, finalAmount) OVERRIDING SYSTEM VALUE VALUES
                                                                                                                ( 1, '2022-12-18 01:28:57', 1, 'Кирилл', 357),
                                                                                                                ( 2, '2022-12-18 01:29:34', 1, 'Алексей', 1837),
                                                                                                                ( 3, '2022-12-18 01:31:11', 1, 'Алексей', 357),
                                                                                                                ( 4, '2022-12-19 01:31:15', 1, 'Олег', 1097),
                                                                                                                ( 5, '2022-12-19 17:44:09', 1, 'Мария', 1837),
                                                                                                                ( 6, '2022-12-19 17:44:58', 1, 'Оксана', 2194),
                                                                                                                ( 7, '2022-12-19 17:48:11', 1, 'Оксана', 357),
                                                                                                                ( 8, '2022-12-19 17:48:40', 1, 'Оксана', 534),
                                                                                                                ( 9, '2022-12-20 18:12:25', 1, 'Игорь', 1200),
                                                                                                                ( 10, '2022-12-20 18:14:45', 1, 'Игорь', 1400),
                                                                                                                ( 11, '2022-12-20 18:16:19', 1, 'Игорь', 820),
                                                                                                                ( 12, '2022-12-20 18:55:00', 1, 'Игорь', 324);


CREATE TABLE bill_orders_map (
                                 id_bill int NOT NULL,
                                 id_order int NOT NULL
) ;


INSERT INTO bill_orders_map (id_bill, id_order) VALUES
                                                    (1, 2),
                                                    (2, 2),
                                                    (3, 2),
                                                    (4, 2),
                                                    (5, 2),
                                                    (6, 2),
                                                    (7, 2),
                                                    (8, 2),
                                                    (9, 2),
                                                    (10, 2),
                                                    (12, 2)
;


CREATE TABLE existing_ingredients (
                                      id_existing_ingredients integer NOT NULL generated BY DEFAULT as identity ( increment 1 start 1 minvalue 1 maxvalue 9000 cache 1),
                                      id_restaurant int NOT NULL,
                                      id_ingredient int NOT NULL,
                                      quantity double precision NOT NULL
) ;


INSERT INTO existing_ingredients ( id_restaurant, id_ingredient, quantity) OVERRIDING SYSTEM VALUE VALUES
                                                                                                       ( 1, 1, 30.00),
                                                                                                       ( 1, 2, 85.00),
                                                                                                       ( 1, 3, 30.00),
                                                                                                       ( 1, 4, 15.00),
                                                                                                       ( 1, 5, 25.00),
                                                                                                       ( 1, 6, 18.00),
                                                                                                       ( 1, 7, 19.00),
                                                                                                       ( 1, 8, 20.00),
                                                                                                       ( 1, 9, 26.00),
                                                                                                       ( 1, 10, 37.00),
                                                                                                       ( 1, 11, 9.00),
                                                                                                       ( 1, 12, 29.00),
                                                                                                       ( 1, 13, 8.00),
                                                                                                       ( 1, 14, 3.00),
                                                                                                       ( 1, 15, 11.00),
                                                                                                       ( 1, 16, 1.00),
                                                                                                       ( 1, 17, 10.00),
                                                                                                       ( 1, 18, 111.00),
                                                                                                       ( 1, 19, 112.65),
                                                                                                       ( 1, 20, 456.45),
                                                                                                       ( 1, 21, 456.30),
                                                                                                       ( 1, 22, 468.80),
                                                                                                       ( 1, 23, 111.00),
                                                                                                       ( 1, 24, 1.00),
                                                                                                       ( 1, 25, 3.00),
                                                                                                       ( 1, 26, 16.00),
                                                                                                       ( 1, 27, 63.00),
                                                                                                       ( 1, 28, 4.00),
                                                                                                       ( 1, 29, 12.00),
                                                                                                       ( 1, 30, 31.00),
                                                                                                       ( 1, 31, 12.00),
                                                                                                       ( 1, 32, 12.00),
                                                                                                       ( 1, 33, 16.00),
                                                                                                       ( 1, 34, 18.00),
                                                                                                       ( 1, 35, 66.00),
                                                                                                       ( 1, 36, 66.00),
                                                                                                       ( 1, 37, 33.00),
                                                                                                       ( 1, 38, 22.00),
                                                                                                       ( 1, 39, 55.00),
                                                                                                       ( 1, 40, 55.00),
                                                                                                       ( 1, 41, 55.00),
                                                                                                       ( 1, 42, 55.00),
                                                                                                       ( 1, 43, 55.00);



CREATE TABLE ingredients (
                             id_ingredient integer NOT NULL  generated BY DEFAULT as identity ( increment 1 start 1 minvalue 1 maxvalue 9000 cache 1),
                             price double precision NOT NULL,
                             ingredient_name varchar(50) NOT NULL,
                             measurement_quantity varchar NOT NULL
);
INSERT INTO ingredients ( price, ingredient_name, measurement_quantity) OVERRIDING SYSTEM VALUE VALUES
                                                                                                    ( 389, 'Уха', 'порции'),
                                                                                                    ( 500, 'Жаркое', 'порции'),
                                                                                                    ( 785, 'Креветки в темпуре', 'порции'),
                                                                                                    ( 247, 'Салат Чука', 'порции'),
                                                                                                    ( 200, 'Греческий салат', 'порции'),
                                                                                                    ( 748, 'Салат с креветками', 'порции'),
                                                                                                    ( 357, 'Овощи запеченные', 'порции'),
                                                                                                    ( 200, 'Медовик', 'порции'),
                                                                                                    ( 256, 'Наполеон', 'порции'),
                                                                                                    ( 357, 'Маффин', 'порции'),
                                                                                                    ( 254, 'Чизкейк', 'порции'),
                                                                                                    ( 55, 'Соус', 'порции'),
                                                                                                    ( 367, 'Суширитто с креветками', 'порции'),
                                                                                                    ( 677, 'Ролл с тунцом', 'порции'),
                                                                                                    ( 487, 'Ролл Филадельфия', 'порции'),
                                                                                                    ( 497, 'Запеченный ролл с беконом', 'порции'),
                                                                                                    ( 462, 'Ролл Калифорния', 'порции'),
                                                                                                    ( 536, 'Рис с креветками', 'порции'),
                                                                                                    ( 60, 'Вода', 'литры'),
                                                                                                    ( 200, 'Чай', 'граммы'),
                                                                                                    ( 320, 'Кофе', 'граммы'),
                                                                                                    ( 236, 'Сок', 'литры'),
                                                                                                    ( 452, 'Осетинский пирог с сыром', 'порции'),
                                                                                                    ( 187, 'Картофель Фри', 'порции'),
                                                                                                    ( 200, 'Скрэмбл с беконом', 'порции'),
                                                                                                    ( 122, 'Сырники', 'порции'),
                                                                                                    ( 327, 'Пицца', 'порции'),
                                                                                                    ( 355.55, 'Солянка', 'порции'),
                                                                                                    ( 350, 'Грибной крем-суп', 'порции'),
                                                                                                    ( 655, 'Том Ям', 'порции'),
                                                                                                    ( 455, 'Сум Кимчи', 'порции'),
                                                                                                    ( 256, 'Шаверма с курицей', 'порции'),
                                                                                                    ( 365, 'Буррито с говядиной', 'порции'),
                                                                                                    ( 555.55, 'Чикенбургер', 'порции'),
                                                                                                    ( 580, 'Фреш-ролл с говядиной', 'порции'),
                                                                                                    ( 900.55, 'Мидии запеченные', 'порции'),
                                                                                                    ( 277.77, 'Кесадилья с курицей', 'порции'),
                                                                                                    ( 233.33, 'Картофель Айдахо', 'порции'),
                                                                                                    ( 222.22, 'Теплый салат с говядиной', 'порции'),
                                                                                                    ( 255.55, 'Легкий сет', 'порции'),
                                                                                                    ( 365, 'Боул с лососем', 'порции'),
                                                                                                    ( 523, 'Рис с овощами по-китайски', 'порции'),
                                                                                                    ( 456, 'Курица терияки с лапщой удон', 'порции');


CREATE TABLE order_offers (
                              id_order int NOT NULL,
                              table_number int NOT NULL,
                              price double precision NOT NULL,
                              id_ingredient int NOT NULL
) ;


INSERT INTO order_offers (id_order, table_number, price, id_ingredient) VALUES
    (2, 5, 0, 0);


CREATE TABLE restaurants (
                             id_restaurant int NOT NULL,
                             name_restaurant varchar(40) DEFAULT NULL

) ;


INSERT INTO restaurants (id_restaurant, name_restaurant  ) VALUES
    (1, 'Ресторан Санкт-Петербург' );

CREATE TABLE restaurant_table (
                                  id_restaurant_table integer NOT NULL generated BY DEFAULT as identity ( increment 1 start 1 minvalue 1 maxvalue 9000 cache 1),
                                  table_number int NOT NULL,
                                  id_restaurant int NOT NULL,
                                  table_status smallint NOT NULL
) ;


INSERT INTO restaurant_table ( table_number, id_restaurant, table_status) OVERRIDING SYSTEM VALUE VALUES
                                                                                                      ( 1, 1, 0),
                                                                                                      ( 2, 1, 0),
                                                                                                      ( 3, 1, 0),
                                                                                                      ( 4, 1, 0),
                                                                                                      ( 5, 1, 0),
                                                                                                      ( 6, 1, 0),
                                                                                                      ( 7, 1, 0),
                                                                                                      ( 8, 1, 0),
                                                                                                      ( 9, 1, 0),
                                                                                                      ( 10, 1, 0),
                                                                                                      ( 11, 1, 0),
                                                                                                      ( 12, 1, 0),
                                                                                                      ( 13, 1, 0),
                                                                                                      ( 14, 1, 0),
                                                                                                      ( 15, 1, 0),
                                                                                                      ( 16, 1, 0),
                                                                                                      ( 17, 1, 0),
                                                                                                      ( 18, 1, 0),
                                                                                                      ( 19, 1, 0),
                                                                                                      ( 20, 1, 0),
                                                                                                      ( 21, 1, 0),
                                                                                                      ( 22, 1, 0),
                                                                                                      ( 23, 1, 0),
                                                                                                      ( 24, 1, 0);


CREATE TABLE role (
                      id_role int NOT NULL,
                      role_name varchar(40) NOT NULL
) ;


INSERT INTO role (id_role, role_name) VALUES
                                          (1, 'Собственник'),
                                          (2, 'Менеджер'),
                                          (3, 'Официант');

CREATE TABLE "users" (
                         id_user integer NOT NULL generated BY DEFAULT as identity ( increment 1 start 1 minvalue 1 maxvalue 9000 cache 1),
                         first_name varchar(40) NOT NULL,
                         username varchar(40) NOT NULL,
                         password varchar(40) NOT NULL,
                         status smallint DEFAULT NULL
) ;


INSERT INTO "users" ( first_name, username, password, status) OVERRIDING SYSTEM VALUE VALUES
                                                                                          ( 'Максим', 'Максим', '1895', 1),
                                                                                          ( 'Никита', 'Никита', '5896', 1),
                                                                                          ( 'Юлия', 'Юлия', '9685', 1),

                                                                                          ( 'Кирилл', 'Кирилл', '7456', 0),
                                                                                          ( 'Алексей', 'Алексей', '4589', 0),
                                                                                          ( 'Олег', 'Олег', '8596', 0),

                                                                                          ( 'Мария', 'Мария', '8569', 0),
                                                                                          ('Оксана', 'Оксана', '5623', 0),
                                                                                          ( 'Игорь', 'Игорь', '7854', 0),
                                                                                          ( 'Сергей', 'Сергей', '9652', 1),
                                                                                          ( 'Матвей', 'Матвей', '7456', 1),
                                                                                          ( 'Константин', 'Константин', '8596', 1),
                                                                                          ( 'Екатерина', 'Екатерина', '8859', 1),
                                                                                          ( 'Виктор', 'Виктор', '8856', 1),
                                                                                          ( 'Александр', 'Александр', '1452', 1),

                                                                                          ( 'Евгений', 'Евгений', '6523', 1),
                                                                                          ( 'Николай', 'Николай', '9856', 0);



CREATE TABLE user_restaurant_map (
                                     id_user integer NOT NULL,
                                     id_restaurant int NOT NULL
) ;


INSERT INTO user_restaurant_map (id_user, id_restaurant) OVERRIDING SYSTEM VALUE VALUES
                                                                                     (1, 1),
                                                                                     (2, 1),
                                                                                     (3, 1),
                                                                                     (4, 1),
                                                                                     (5, 1),
                                                                                     (6, 1),
                                                                                     (7, 1),
                                                                                     (8, 1),
                                                                                     (9, 1),
                                                                                     (10, 1),
                                                                                     (11, 1),
                                                                                     (12, 1),
                                                                                     (13, 1),
                                                                                     (14, 1),
                                                                                     (15, 1),
                                                                                     (16, 1),
                                                                                     (17, 1)
;




CREATE TABLE user_role_map (
                               id_user integer NOT NULL,
                               id_role int NOT NULL
);

INSERT INTO user_role_map (id_user, id_role) OVERRIDING SYSTEM VALUE VALUES
                                                                         (1, 1),
                                                                         (2, 1),
                                                                         (3, 3),
                                                                         (4, 3),
                                                                         (5, 3),
                                                                         (6, 3),
                                                                         (7, 3),
                                                                         (8, 3),
                                                                         (9, 3),
                                                                         (10, 3),
                                                                         (11, 1),
                                                                         (12, 1),
                                                                         (13, 1),
                                                                         (14, 1),
                                                                         (15, 3),
                                                                         (16, 3),
                                                                         (17, 1);

ALTER TABLE bill
    ADD PRIMARY KEY (id_bill);
CREATE INDEX bill_ibfk_1 ON bill ( table_number );
CREATE INDEX bill_ibfk_3 ON bill ( id_restaurant );

CREATE INDEX id_bill ON bill_orders_map (id_bill);

ALTER TABLE existing_ingredients
    ADD PRIMARY KEY (id_existing_ingredients);
CREATE INDEX mejh ON existing_ingredients ( id_ingredient );
CREATE INDEX mejh2 ON existing_ingredients ( id_restaurant );

ALTER TABLE ingredients
    ADD PRIMARY KEY (id_ingredient);
CREATE UNIQUE INDEX ingredient_name ON ingredients ( ingredient_name );
CREATE UNIQUE INDEX ingredient_name_2 ON ingredients ( ingredient_name );
CREATE UNIQUE INDEX ingredient_name_3 ON ingredients ( ingredient_name );
CREATE UNIQUE INDEX ingredient_name_4 ON ingredients ( ingredient_name );

ALTER TABLE order_offers
    ADD PRIMARY KEY (id_order);

ALTER TABLE restaurants
    ADD PRIMARY KEY (id_restaurant);
CREATE UNIQUE INDEX  name_restaurant ON restaurants (name_restaurant);


ALTER TABLE restaurant_table
    ADD PRIMARY KEY (id_restaurant_table);

CREATE INDEX id_restaurant ON user_restaurant_map (id_restaurant);

ALTER TABLE role
    ADD PRIMARY KEY (id_role);

